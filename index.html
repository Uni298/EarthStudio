<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earth Studio Clone - CesiumJS Keyframe Animation</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%234a9eff'/><circle cx='50' cy='50' r='35' fill='%2300d084'/></svg>">
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.112/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.112/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
</head>

<body>
    <div id="app-container">
        <!-- Main Viewer -->
        <div id="cesium-container"></div>

        <!-- Property Panel (Left) -->
        <div id="property-panel">
            <div class="panel-header" style="display: flex; flex-direction: column; gap: 10px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3>Earth Studio</h3>
                    <button id="btn-toggle-mask" class="btn-icon" title="ÂãïÁîª„Éó„É¨„Éì„É•„ÉºÊû†">üëÅÔ∏è</button>
                </div>
                <!-- Project Controls -->
                <div style="display: flex; gap: 5px;">
                    <button id="btn-save-project" class="btn-secondary" style="flex: 1; font-size: 12px; padding: 6px;">
                        <span class="icon">üíæ</span> „Éó„É≠„Ç∏„Çß„ÇØ„Éà‰øùÂ≠ò
                    </button>
                    <button id="btn-load-project" class="btn-secondary" style="flex: 1; font-size: 12px; padding: 6px;">
                        <span class="icon">üìÇ</span> Èñã„Åè
                    </button>
                    <input type="file" id="input-load-project" accept=".json" style="display: none;">
                </div>

                <!-- Export Button -->
                <button id="btn-export" class="btn-primary" style="width: 100%;">
                    <span class="icon">üé¨</span> „Ç®„ÇØ„Çπ„Éù„Éº„Éà
                </button>
            </div>
            <div class="scroll-content">
                <div class="property-section">
                    <h4>„Ç≠„Éº„Éï„É¨„Éº„É†Ë®≠ÂÆö</h4>
                    <div class="property-group">
                        <label>Á∑ØÂ∫¶ (Latitude)</label>
                        <input type="number" id="input-latitude" step="0.0001" value="35.6762">
                        <span class="unit">¬∞</span>
                    </div>
                    <div class="property-group">
                        <label>ÁµåÂ∫¶ (Longitude)</label>
                        <input type="number" id="input-longitude" step="0.0001" value="139.6503">
                        <span class="unit">¬∞</span>
                    </div>
                    <div class="property-group">
                        <label>È´òÂ∫¶ (Height)</label>
                        <input type="number" id="input-height" step="100" value="10000">
                        <span class="unit">m</span>
                    </div>
                </div>

                <div class="property-section">
                    <h4>Âêë„Åç</h4>
                    <div class="property-group">
                        <label>ÂõûËª¢ (Heading / ZËª∏)</label>
                        <div style="display: flex; gap: 5px; align-items: center;">
                            <input type="range" id="input-heading-slider" min="-180" max="180" value="0"
                                style="flex: 1;">
                            <input type="number" id="input-heading" step="1" min="-180" max="180" value="0"
                                style="width: 60px;">
                        </div>
                        <span class="unit">¬∞</span>
                    </div>
                    <div class="property-group">
                        <label>„Éî„ÉÉ„ÉÅ (Pitch / XËª∏)</label>
                        <div style="display: flex; gap: 5px; align-items: center;">
                            <input type="range" id="input-pitch-slider" min="-90" max="0" value="-45" style="flex: 1;">
                            <input type="number" id="input-pitch" step="1" min="-90" max="0" value="-45"
                                style="width: 60px;">
                        </div>
                        <span class="unit">¬∞</span>
                    </div>
                    <div class="property-group">
                        <label>„Ç∫„Éº„É† (Zoom / YËª∏)</label>
                        <div style="display: flex; gap: 5px; align-items: center;">
                            <input type="range" id="input-fov" min="10" max="120" value="60" style="flex: 1;">
                            <span class="value" id="fov-value" style="width: 40px; text-align: right;">60¬∞</span>
                        </div>
                    </div>
                </div>

                <div class="property-section">
                    <h4>„Ç´„É°„É©</h4>
                    <!-- FOV moved to above -->
                </div>

                <div class="property-section">
                    <h4>Ë£úÈñì</h4>
                    <div class="property-group">
                        <label>„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Á®ÆÈ°û</label>
                        <select id="select-interpolation">
                            <option value="linear">„É™„Éã„Ç¢ (Linear)</option>
                            <option value="easeIn">„Ç§„Éº„Ç∫„Ç§„É≥ (Ease In)</option>
                            <option value="easeOut">„Ç§„Éº„Ç∫„Ç¢„Ç¶„Éà (Ease Out)</option>
                            <option value="easeInOut" selected>„Ç§„Éº„Ç∫„Ç§„É≥„Ç¢„Ç¶„Éà (Ease In-Out)</option>
                            <option value="bezier">„Éô„Ç∏„Çß (Bezier)</option>
                        </select>
                    </div>
                </div>

                <div class="property-actions">
                    <button id="btn-add-keyframe" class="btn-success">
                        <span class="icon">‚ûï</span> „Ç≠„Éº„Éï„É¨„Éº„É†ËøΩÂä†
                    </button>
                    <button id="btn-update-keyframe" class="btn-primary" disabled>
                        <span class="icon">üíæ</span> Êõ¥Êñ∞
                    </button>
                    <button id="btn-delete-keyframe" class="btn-danger" disabled>
                        <span class="icon">üóëÔ∏è</span> ÂâäÈô§
                    </button>
                </div>
            </div> <!-- End scroll-content -->
        </div>

        <!-- Timeline Panel (Bottom) -->
        <div id="timeline-panel" class="panel">
            <div class="timeline-header">
                <div class="playback-controls">
                    <button id="btn-play" class="btn-icon" title="ÂÜçÁîü">‚ñ∂Ô∏è</button>
                    <button id="btn-pause" class="btn-icon" title="‰∏ÄÊôÇÂÅúÊ≠¢" disabled>‚è∏Ô∏è</button>
                    <button id="btn-stop" class="btn-icon" title="ÂÅúÊ≠¢">‚èπÔ∏è</button>
                    <button id="btn-step-back" class="btn-icon" title="Ââç„ÅÆ„Éï„É¨„Éº„É†">‚èÆÔ∏è</button>
                    <button id="btn-step-forward" class="btn-icon" title="Ê¨°„ÅÆ„Éï„É¨„Éº„É†">‚è≠Ô∏è</button>
                </div>
                <div class="time-display">
                    <span id="current-time">00:00.000</span> / <span id="total-time">00:10.000</span>
                </div>
                <div class="timeline-settings">
                    <label>FPS:</label>
                    <select id="select-fps">
                        <option value="24">24</option>
                        <option value="30" selected>30</option>
                        <option value="60">60</option>
                    </select>
                    <label>Èï∑„Åï:</label>
                    <input type="number" id="input-duration" min="1" max="300" value="10" step="1">
                    <span>Áßí</span>
                </div>
            </div>
            <div class="timeline-container">
                <canvas id="timeline-canvas"></canvas>
            </div>
            <!-- Scrollbar removed for fit-to-view mode -->
            <div class="progress-container">
                <input type="range" id="progress-slider" min="0" max="1000" value="0" step="1">
            </div>
        </div>

        <!-- Export Dialog -->
        <div id="export-dialog" class="dialog" style="display: none;">
            <div class="dialog-content">
                <div class="dialog-header">
                    <h3>ÂãïÁîª„Ç®„ÇØ„Çπ„Éù„Éº„ÉàË®≠ÂÆö</h3>
                    <button id="btn-close-dialog" class="btn-close">‚úñÔ∏è</button>
                </div>
                <div class="dialog-body">
                    <div class="property-group">
                        <label>Ëß£ÂÉèÂ∫¶</label>
                        <select id="export-resolution">
                            <option value="1920x1080" selected>1920x1080 (Full HD)</option>
                            <option value="1280x720">1280x720 (HD)</option>
                            <option value="3840x2160">3840x2160 (4K)</option>
                        </select>
                    </div>
                    <div class="property-group">
                        <label>„Éï„É¨„Éº„É†„É¨„Éº„Éà</label>
                        <select id="export-fps">
                            <option value="24">24 FPS</option>
                            <option value="30" selected>30 FPS</option>
                            <option value="60">60 FPS</option>
                        </select>
                    </div>
                    <div class="property-group">
                        <label>ÂìÅË≥™</label>
                        <select id="export-quality">
                            <option value="high" selected>È´òÂìÅË≥™</option>
                            <option value="medium">‰∏≠ÂìÅË≥™</option>
                            <option value="low">‰ΩéÂìÅË≥™</option>
                        </select>
                    </div>
                    <div id="export-progress" style="display: none;">
                        <div class="progress-bar">
                            <div id="export-progress-fill" class="progress-fill"></div>
                        </div>
                        <div class="progress-text">
                            <span id="export-status">Ê∫ñÂÇô‰∏≠...</span>
                            <span id="export-percentage">0%</span>
                        </div>
                    </div>
                </div>
                <div class="dialog-footer">
                    <button id="btn-start-export" class="btn-primary">„Ç®„ÇØ„Çπ„Éù„Éº„ÉàÈñãÂßã</button>
                    <button id="btn-server-export" class="btn-primary"
                        style="background: linear-gradient(135deg, #7b61ff, #aa61ff);">
                        <span class="icon">‚òÅÔ∏è</span> „Çµ„Éº„Éê„Éº„ÅßÂÆüË°å
                    </button>
                    <button id="btn-cancel-export" class="btn-secondary">„Ç≠„É£„É≥„Çª„É´</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="js/interpolation.js"></script>
    <script type="module" src="js/keyframe-manager.js"></script>
    <script type="module" src="js/cesium-manager.js"></script>
    <script type="module" src="js/timeline-editor.js"></script>
    <script type="module" src="js/property-panel.js"></script>
    <script type="module" src="js/animation-controller.js"></script>
    <script type="module" src="js/video-exporter.js"></script>
    <script type="module" src="js/app.js"></script>
</body>

</html>